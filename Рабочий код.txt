ВЫБРАТЬ РАЗРЕШЕННЫЕ
	СценарииПланирования.Ссылка КАК СценарийПланирования,
	СценарииПланирования.ПериодичностьПланирования КАК ПериодичностьПланирования,
	СценарииПланирования.СегментОбъектовНедвижимости КАК Сегмент
ПОМЕСТИТЬ втСценарийТрейдИн
ИЗ
	Справочник.УПДК_СценарииПланирования КАК СценарииПланирования
ГДЕ
	СценарииПланирования.Ссылка = &СценарийПланированияТрейдИн
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	ТаблицаОбъектовСегмента.ОбъектНедвижимости КАК ОбъектНедвижимости
ПОМЕСТИТЬ втТаблицаОбъектовСегмента
ИЗ
	РегистрСведений.УПДК_ОбъектыНедвижимостиСегмента КАК ТаблицаОбъектовСегмента
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ втСценарийТрейдИн КАК Сценарий
		ПО ТаблицаОбъектовСегмента.Сегмент = Сценарий.Сегмент

ИНДЕКСИРОВАТЬ ПО
	ОбъектНедвижимости
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ ПЕРВЫЕ 1
	Сценарий.СценарийПланирования КАК СценарийПланирования,
	Сценарий.ПериодичностьПланирования КАК ВидПериода,
	ТекущиеТочки.ТочкаПланирования КАК Точка,
	ТекущиеТочки.ТочкаПланирования.ДатаНачала КАК ДатаНачала
ПОМЕСТИТЬ АктивныеТочкиТрейдИн
ИЗ
	РегистрСведений.УПДК_АктивныеТочкиПланирования КАК ТекущиеТочки
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ втСценарийТрейдИн КАК Сценарий
		ПО ТекущиеТочки.СценарийПланирования = Сценарий.СценарийПланирования
{ГДЕ
	(ТекущиеТочки.ТочкаПланирования = &ТочкаПланированияТрейдИн)}

УПОРЯДОЧИТЬ ПО
	ДатаНачала УБЫВ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	АктивныеТочки.СценарийПланирования КАК СценарийПланирования,
	АктивныеТочки.ВидПериода КАК ВидПериода,
	ПредыдущиеТочки.ТочкаПланирования КАК Точка,
	ПредыдущиеТочки.ТочкаПланирования.ДатаНачала КАК ДатаНачала,
	МИНИМУМ(ДОБАВИТЬКДАТЕ(ЕСТЬNULL(БудущиеТочки.ТочкаПланирования.ДатаНачала, АктивныеТочки.ДатаНачала), СЕКУНДА, -1)) КАК ДатаОкончания
ПОМЕСТИТЬ ПредыдущиеТочкиТрейдИн
ИЗ
	АктивныеТочкиТрейдИн КАК АктивныеТочки
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.УПДК_АктивныеТочкиПланирования КАК ПредыдущиеТочки
		ПО АктивныеТочки.СценарийПланирования = ПредыдущиеТочки.СценарийПланирования
			И АктивныеТочки.Точка.ДатаНачала > ПредыдущиеТочки.ТочкаПланирования.ДатаНачала
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УПДК_АктивныеТочкиПланирования КАК БудущиеТочки
		ПО (ПредыдущиеТочки.СценарийПланирования = БудущиеТочки.СценарийПланирования)
			И (ПредыдущиеТочки.ТочкаПланирования.ДатаНачала < БудущиеТочки.ТочкаПланирования.ДатаНачала)
			И (БудущиеТочки.ТочкаПланирования.ДатаНачала < АктивныеТочки.ДатаНачала)

СГРУППИРОВАТЬ ПО
	АктивныеТочки.СценарийПланирования,
	АктивныеТочки.ВидПериода,
	ПредыдущиеТочки.ТочкаПланирования,
	ПредыдущиеТочки.ТочкаПланирования.ДатаНачала
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	АктивныеТочки.СценарийПланирования КАК СценарийПланирования,
	АктивныеТочки.Точка КАК Точка,
	АктивныеТочки.ДатаНачала КАК ДатаНачала,
	ИСТИНА КАК АктивнаяТочка,
	NULL КАК ДатаОкончания,
	АктивныеТочки.ВидПериода КАК ВидПериода
ПОМЕСТИТЬ ТочкиТрейдИн
ИЗ
	АктивныеТочкиТрейдИн КАК АктивныеТочки

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ПредыдущиеТочки.СценарийПланирования,
	ПредыдущиеТочки.Точка,
	ПредыдущиеТочки.ДатаНачала,
	ЛОЖЬ,
	ПредыдущиеТочки.ДатаОкончания,
	ПредыдущиеТочки.ВидПериода
ИЗ
	ПредыдущиеТочкиТрейдИн КАК ПредыдущиеТочки
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	Точки.ВидПериода КАК ВидПериода,
	ВЫБОР
		КОГДА Точки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.День)
			ТОГДА ПлановыеПоказателиОбороты.ПериодДень
		КОГДА Точки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Неделя)
			ТОГДА ПлановыеПоказателиОбороты.ПериодНеделя
		КОГДА Точки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Месяц)
			ТОГДА ПлановыеПоказателиОбороты.ПериодМесяц
		КОГДА Точки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Квартал)
			ТОГДА ПлановыеПоказателиОбороты.ПериодКвартал
		КОГДА Точки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Год)
			ТОГДА ПлановыеПоказателиОбороты.ПериодГод
	КОНЕЦ КАК Период,
	ПлановыеПоказателиОбороты.КоличествоСделокОборот КАК КоличествоСделок,
	ПлановыеПоказателиОбороты.СуммаПродажиОборот КАК СуммаПродажи
ПОМЕСТИТЬ ПлановыеПоказателиТрейдИн
ИЗ
	ТочкиТрейдИн КАК Точки
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.УПДК_ПлановыеПоказатели.Обороты({(&ДатаНачала)}, {(&ДатаОкончания)}, Авто, ) КАК ПлановыеПоказателиОбороты
		ПО (ВЫБОР
				КОГДА Точки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.День)
					ТОГДА ВЫБОР
							КОГДА Точки.АктивнаяТочка
								ТОГДА Точки.ДатаНачала <= ПлановыеПоказателиОбороты.ПериодДень
							ИНАЧЕ Точки.ДатаНачала <= ПлановыеПоказателиОбороты.ПериодДень
									И Точки.ДатаОкончания >= ПлановыеПоказателиОбороты.ПериодДень
						КОНЕЦ
				КОГДА Точки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Неделя)
					ТОГДА ВЫБОР
							КОГДА Точки.АктивнаяТочка
								ТОГДА Точки.ДатаНачала <= ПлановыеПоказателиОбороты.ПериодНеделя
							ИНАЧЕ Точки.ДатаНачала <= ПлановыеПоказателиОбороты.ПериодНеделя
									И Точки.ДатаОкончания >= ПлановыеПоказателиОбороты.ПериодНеделя
						КОНЕЦ
				КОГДА Точки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Месяц)
					ТОГДА ВЫБОР
							КОГДА Точки.АктивнаяТочка
								ТОГДА Точки.ДатаНачала <= ПлановыеПоказателиОбороты.ПериодМесяц
							ИНАЧЕ Точки.ДатаНачала <= ПлановыеПоказателиОбороты.ПериодМесяц
									И Точки.ДатаОкончания >= ПлановыеПоказателиОбороты.ПериодМесяц
						КОНЕЦ
				КОГДА Точки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Квартал)
					ТОГДА ВЫБОР
							КОГДА Точки.АктивнаяТочка
								ТОГДА Точки.ДатаНачала <= ПлановыеПоказателиОбороты.ПериодКвартал
							ИНАЧЕ Точки.ДатаНачала <= ПлановыеПоказателиОбороты.ПериодКвартал
									И Точки.ДатаОкончания >= ПлановыеПоказателиОбороты.ПериодКвартал
						КОНЕЦ
				КОГДА Точки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Год)
					ТОГДА ВЫБОР
							КОГДА Точки.АктивнаяТочка
								ТОГДА Точки.ДатаНачала <= ПлановыеПоказателиОбороты.ПериодГод
							ИНАЧЕ Точки.ДатаНачала <= ПлановыеПоказателиОбороты.ПериодГод
									И Точки.ДатаОкончания >= ПлановыеПоказателиОбороты.ПериодГод
						КОНЕЦ
				ИНАЧЕ ЛОЖЬ
			КОНЕЦ)
			И Точки.СценарийПланирования = ПлановыеПоказателиОбороты.СценарийПланирования
			И Точки.Точка = ПлановыеПоказателиОбороты.ТочкаПланирования
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	СценарииПланирования.Ссылка КАК СценарийПланирования,
	СценарииПланирования.ПериодичностьПланирования КАК ПериодичностьПланирования,
	СценарииПланирования.СегментОбъектовНедвижимости КАК Сегмент
ПОМЕСТИТЬ втСценарийВторичка
ИЗ
	Справочник.УПДК_СценарииПланирования КАК СценарииПланирования
ГДЕ
	СценарииПланирования.Ссылка = &СценарийПланированияВторичка
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ ПЕРВЫЕ 1
	Сценарий.СценарийПланирования КАК СценарийПланирования,
	Сценарий.ПериодичностьПланирования КАК ВидПериода,
	ТекущиеТочки.ТочкаПланирования КАК Точка,
	ТекущиеТочки.ТочкаПланирования.ДатаНачала КАК ДатаНачала
ПОМЕСТИТЬ АктивныеТочкиВторичка
ИЗ
	РегистрСведений.УПДК_АктивныеТочкиПланирования КАК ТекущиеТочки
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ втСценарийВторичка КАК Сценарий
		ПО ТекущиеТочки.СценарийПланирования = Сценарий.СценарийПланирования
{ГДЕ
	(ТекущиеТочки.ТочкаПланирования = &ТочкаПланированияВторичка)}

УПОРЯДОЧИТЬ ПО
	ДатаНачала УБЫВ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	АктивныеТочки.СценарийПланирования КАК СценарийПланирования,
	АктивныеТочки.ВидПериода КАК ВидПериода,
	ПредыдущиеТочки.ТочкаПланирования КАК Точка,
	ПредыдущиеТочки.ТочкаПланирования.ДатаНачала КАК ДатаНачала,
	МИНИМУМ(ДОБАВИТЬКДАТЕ(ЕСТЬNULL(БудущиеТочки.ТочкаПланирования.ДатаНачала, АктивныеТочки.ДатаНачала), СЕКУНДА, -1)) КАК ДатаОкончания
ПОМЕСТИТЬ ПредыдущиеТочкиВторичка
ИЗ
	АктивныеТочкиВторичка КАК АктивныеТочки
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.УПДК_АктивныеТочкиПланирования КАК ПредыдущиеТочки
		ПО АктивныеТочки.СценарийПланирования = ПредыдущиеТочки.СценарийПланирования
			И АктивныеТочки.Точка.ДатаНачала > ПредыдущиеТочки.ТочкаПланирования.ДатаНачала
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УПДК_АктивныеТочкиПланирования КАК БудущиеТочки
		ПО (ПредыдущиеТочки.СценарийПланирования = БудущиеТочки.СценарийПланирования)
			И (ПредыдущиеТочки.ТочкаПланирования.ДатаНачала < БудущиеТочки.ТочкаПланирования.ДатаНачала)
			И (БудущиеТочки.ТочкаПланирования.ДатаНачала < АктивныеТочки.ДатаНачала)

СГРУППИРОВАТЬ ПО
	АктивныеТочки.СценарийПланирования,
	АктивныеТочки.ВидПериода,
	ПредыдущиеТочки.ТочкаПланирования,
	ПредыдущиеТочки.ТочкаПланирования.ДатаНачала
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	АктивныеТочки.СценарийПланирования КАК СценарийПланирования,
	АктивныеТочки.Точка КАК Точка,
	АктивныеТочки.ДатаНачала КАК ДатаНачала,
	ИСТИНА КАК АктивнаяТочка,
	NULL КАК ДатаОкончания,
	АктивныеТочки.ВидПериода КАК ВидПериода
ПОМЕСТИТЬ ТочкиВторичка
ИЗ
	АктивныеТочкиВторичка КАК АктивныеТочки

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ПредыдущиеТочки.СценарийПланирования,
	ПредыдущиеТочки.Точка,
	ПредыдущиеТочки.ДатаНачала,
	ЛОЖЬ,
	ПредыдущиеТочки.ДатаОкончания,
	ПредыдущиеТочки.ВидПериода
ИЗ
	ПредыдущиеТочкиВторичка КАК ПредыдущиеТочки
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	Точки.ВидПериода КАК ВидПериода,
	ВЫБОР
		КОГДА Точки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.День)
			ТОГДА ПлановыеПоказателиОбороты.ПериодДень
		КОГДА Точки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Неделя)
			ТОГДА ПлановыеПоказателиОбороты.ПериодНеделя
		КОГДА Точки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Месяц)
			ТОГДА ПлановыеПоказателиОбороты.ПериодМесяц
		КОГДА Точки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Квартал)
			ТОГДА ПлановыеПоказателиОбороты.ПериодКвартал
		КОГДА Точки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Год)
			ТОГДА ПлановыеПоказателиОбороты.ПериодГод
	КОНЕЦ КАК Период,
	ПлановыеПоказателиОбороты.КоличествоСделокОборот КАК КоличествоСделок,
	ПлановыеПоказателиОбороты.СуммаПродажиОборот КАК СуммаПродажи
ПОМЕСТИТЬ ПлановыеПоказателиВторичка
ИЗ
	ТочкиВторичка КАК Точки
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.УПДК_ПлановыеПоказатели.Обороты({(&ДатаНачала)}, {(&ДатаОкончания)}, Авто, ) КАК ПлановыеПоказателиОбороты
		ПО (ВЫБОР
				КОГДА Точки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.День)
					ТОГДА ВЫБОР
							КОГДА Точки.АктивнаяТочка
								ТОГДА Точки.ДатаНачала <= ПлановыеПоказателиОбороты.ПериодДень
							ИНАЧЕ Точки.ДатаНачала <= ПлановыеПоказателиОбороты.ПериодДень
									И Точки.ДатаОкончания >= ПлановыеПоказателиОбороты.ПериодДень
						КОНЕЦ
				КОГДА Точки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Неделя)
					ТОГДА ВЫБОР
							КОГДА Точки.АктивнаяТочка
								ТОГДА Точки.ДатаНачала <= ПлановыеПоказателиОбороты.ПериодНеделя
							ИНАЧЕ Точки.ДатаНачала <= ПлановыеПоказателиОбороты.ПериодНеделя
									И Точки.ДатаОкончания >= ПлановыеПоказателиОбороты.ПериодНеделя
						КОНЕЦ
				КОГДА Точки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Месяц)
					ТОГДА ВЫБОР
							КОГДА Точки.АктивнаяТочка
								ТОГДА Точки.ДатаНачала <= ПлановыеПоказателиОбороты.ПериодМесяц
							ИНАЧЕ Точки.ДатаНачала <= ПлановыеПоказателиОбороты.ПериодМесяц
									И Точки.ДатаОкончания >= ПлановыеПоказателиОбороты.ПериодМесяц
						КОНЕЦ
				КОГДА Точки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Квартал)
					ТОГДА ВЫБОР
							КОГДА Точки.АктивнаяТочка
								ТОГДА Точки.ДатаНачала <= ПлановыеПоказателиОбороты.ПериодКвартал
							ИНАЧЕ Точки.ДатаНачала <= ПлановыеПоказателиОбороты.ПериодКвартал
									И Точки.ДатаОкончания >= ПлановыеПоказателиОбороты.ПериодКвартал
						КОНЕЦ
				КОГДА Точки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Год)
					ТОГДА ВЫБОР
							КОГДА Точки.АктивнаяТочка
								ТОГДА Точки.ДатаНачала <= ПлановыеПоказателиОбороты.ПериодГод
							ИНАЧЕ Точки.ДатаНачала <= ПлановыеПоказателиОбороты.ПериодГод
									И Точки.ДатаОкончания >= ПлановыеПоказателиОбороты.ПериодГод
						КОНЕЦ
				ИНАЧЕ ЛОЖЬ
			КОНЕЦ)
			И Точки.СценарийПланирования = ПлановыеПоказателиОбороты.СценарийПланирования
			И Точки.Точка = ПлановыеПоказателиОбороты.ТочкаПланирования
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	ПлановыеПоказателиТрейдИн.ВидПериода КАК ВидПериода,
	ПлановыеПоказателиТрейдИн.Период КАК Период,
	ПлановыеПоказателиТрейдИн.КоличествоСделок КАК КоличествоСделокТрейдИн,
	ПлановыеПоказателиТрейдИн.СуммаПродажи КАК СуммаПродажиТрейдИн,
	ПлановыеПоказателиВторичка.КоличествоСделок КАК КоличествоСделокВторичка,
	ПлановыеПоказателиВторичка.СуммаПродажи КАК СуммаПродажиВторичка
ПОМЕСТИТЬ ПлановыеПоказатели
ИЗ
	ПлановыеПоказателиТрейдИн КАК ПлановыеПоказателиТрейдИн
		ЛЕВОЕ СОЕДИНЕНИЕ ПлановыеПоказателиВторичка КАК ПлановыеПоказателиВторичка
		ПО (ИСТИНА)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВЫБОР
		КОГДА АктивныеТочки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.День)
			ТОГДА НАЧАЛОПЕРИОДА(ДоговорНаПокупкуПоОбмену.Дата, ДЕНЬ)
		КОГДА АктивныеТочки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Неделя)
			ТОГДА НАЧАЛОПЕРИОДА(ДоговорНаПокупкуПоОбмену.Дата, НЕДЕЛЯ)
		КОГДА АктивныеТочки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Месяц)
			ТОГДА НАЧАЛОПЕРИОДА(ДоговорНаПокупкуПоОбмену.Дата, МЕСЯЦ)
		КОГДА АктивныеТочки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Квартал)
			ТОГДА НАЧАЛОПЕРИОДА(ДоговорНаПокупкуПоОбмену.Дата, КВАРТАЛ)
		КОГДА АктивныеТочки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Год)
			ТОГДА НАЧАЛОПЕРИОДА(ДоговорНаПокупкуПоОбмену.Дата, ГОД)
	КОНЕЦ КАК Период,
	АктивныеТочки.ВидПериода КАК ВидПериода,
	СУММА(1) КАК КоличествоВыкупВторички,
	СУММА(ДоговорНаПокупкуПоОбмену.СуммаДокумента) КАК СуммаПродажВыкупВторички
ПОМЕСТИТЬ ВыкупленоВторички
ИЗ
	АктивныеТочкиТрейдИн КАК АктивныеТочки
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ДоговорНаПокупкуПоОбмену КАК ДоговорНаПокупкуПоОбмену
		ПО (ИСТИНА)
ГДЕ
	ДоговорНаПокупкуПоОбмену.Статус = ЗНАЧЕНИЕ(перечисление.статусыдоговорнапокупкупообмену.подписан)
{ГДЕ
	(ДоговорНаПокупкуПоОбмену.Дата МЕЖДУ &ДатаНачала И &ДатаОкончания)}

СГРУППИРОВАТЬ ПО
	АктивныеТочки.ВидПериода,
	ВЫБОР
		КОГДА АктивныеТочки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.День)
			ТОГДА НАЧАЛОПЕРИОДА(ДоговорНаПокупкуПоОбмену.Дата, ДЕНЬ)
		КОГДА АктивныеТочки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Неделя)
			ТОГДА НАЧАЛОПЕРИОДА(ДоговорНаПокупкуПоОбмену.Дата, НЕДЕЛЯ)
		КОГДА АктивныеТочки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Месяц)
			ТОГДА НАЧАЛОПЕРИОДА(ДоговорНаПокупкуПоОбмену.Дата, МЕСЯЦ)
		КОГДА АктивныеТочки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Квартал)
			ТОГДА НАЧАЛОПЕРИОДА(ДоговорНаПокупкуПоОбмену.Дата, КВАРТАЛ)
		КОГДА АктивныеТочки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Год)
			ТОГДА НАЧАЛОПЕРИОДА(ДоговорНаПокупкуПоОбмену.Дата, ГОД)
	КОНЕЦ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВЫБОР
		КОГДА АктивныеТочки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.День)
			ТОГДА НАЧАЛОПЕРИОДА(ПодтвержденыеДоговораСПокупателямиСрезПервых.Период, ДЕНЬ)
		КОГДА АктивныеТочки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Неделя)
			ТОГДА НАЧАЛОПЕРИОДА(ПодтвержденыеДоговораСПокупателямиСрезПервых.Период, НЕДЕЛЯ)
		КОГДА АктивныеТочки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Месяц)
			ТОГДА НАЧАЛОПЕРИОДА(ПодтвержденыеДоговораСПокупателямиСрезПервых.Период, МЕСЯЦ)
		КОГДА АктивныеТочки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Квартал)
			ТОГДА НАЧАЛОПЕРИОДА(ПодтвержденыеДоговораСПокупателямиСрезПервых.Период, КВАРТАЛ)
		КОГДА АктивныеТочки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Год)
			ТОГДА НАЧАЛОПЕРИОДА(ПодтвержденыеДоговораСПокупателямиСрезПервых.Период, ГОД)
	КОНЕЦ КАК Период,
	АктивныеТочки.ВидПериода КАК ВидПериода,
	СУММА(ПроданнаяНедвижимостьОбороты.КоличествоОборот) КАК КоличествоСделокСТИ,
	СУММА(ПроданнаяНедвижимостьОбороты.СуммаОборот) КАК СуммаПродажиСТИ
ПОМЕСТИТЬ ЗаключенныеДоговораСТИ
ИЗ
	АктивныеТочкиТрейдИн КАК АктивныеТочки
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.УПДК_ПодтвержденыеДоговораСПокупателями.СрезПоследних({(&ДатаОкончания)}, ВидПодтверждения = &ВидПодтвержденияДоговора) КАК ПодтвержденыеДоговораСПокупателямиСрезПоследних
		ПО (ИСТИНА)
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.УПДК_ПодтвержденыеДоговораСПокупателями.СрезПервых(, ВидПодтверждения = &ВидПодтвержденияДоговора) КАК ПодтвержденыеДоговораСПокупателямиСрезПервых
		ПО (ПодтвержденыеДоговораСПокупателямиСрезПоследних.ДоговорСПокупателем = ПодтвержденыеДоговораСПокупателямиСрезПервых.ДоговорСПокупателем)
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.УПДК_ПродажиНедвижимости.Обороты(
				{(&ДатаНачала)},
				{(&ДатаОкончания)},
				Авто,
				ДоговорСПокупателем.ЭтапыОплаты.ФормаОплаты В
						(ВЫБРАТЬ
							УПДК_ФормыОплаты.Ссылка КАК ссылка
						ИЗ
							ПланВидовХарактеристик.УПДК_ФормыОплаты КАК УПДК_ФормыОплаты
						ГДЕ
							УПДК_ФормыОплаты.ТипОплаты = ЗНАЧЕНИЕ(Перечисление.ТипыДвиженияДенежныхСредств.ТрейдИн))
					И ДоговорСПокупателем.ВидПравовогоДокумента.ТипДоговора В (ЗНАЧЕНИЕ(перечисление.УПДК_ТипыДоговоров.ДДУ), ЗНАЧЕНИЕ(перечисление.УПДК_ТипыДоговоров.ДКП))
					И ДоговорСПокупателем.Статус = ЗНАЧЕНИЕ(перечисление.СтатусыДоговоровСПокупателями.подписан)) КАК ПроданнаяНедвижимостьОбороты
		ПО (ПодтвержденыеДоговораСПокупателямиСрезПоследних.ДоговорСПокупателем = ПроданнаяНедвижимостьОбороты.ДоговорСПокупателем)
ГДЕ
	ПодтвержденыеДоговораСПокупателямиСрезПоследних.Подтвержден
{ГДЕ
	(НАЧАЛОПЕРИОДА(ПодтвержденыеДоговораСПокупателямиСрезПоследних.Период, ДЕНЬ) >= &ДатаНачала),
	(НАЧАЛОПЕРИОДА(ПодтвержденыеДоговораСПокупателямиСрезПоследних.Период, ДЕНЬ) <= &ДатаОкончания)}

СГРУППИРОВАТЬ ПО
	ВЫБОР
		КОГДА АктивныеТочки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.День)
			ТОГДА НАЧАЛОПЕРИОДА(ПодтвержденыеДоговораСПокупателямиСрезПервых.Период, ДЕНЬ)
		КОГДА АктивныеТочки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Неделя)
			ТОГДА НАЧАЛОПЕРИОДА(ПодтвержденыеДоговораСПокупателямиСрезПервых.Период, НЕДЕЛЯ)
		КОГДА АктивныеТочки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Месяц)
			ТОГДА НАЧАЛОПЕРИОДА(ПодтвержденыеДоговораСПокупателямиСрезПервых.Период, МЕСЯЦ)
		КОГДА АктивныеТочки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Квартал)
			ТОГДА НАЧАЛОПЕРИОДА(ПодтвержденыеДоговораСПокупателямиСрезПервых.Период, КВАРТАЛ)
		КОГДА АктивныеТочки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Год)
			ТОГДА НАЧАЛОПЕРИОДА(ПодтвержденыеДоговораСПокупателямиСрезПервых.Период, ГОД)
	КОНЕЦ,
	АктивныеТочки.ВидПериода
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВЫБОР
		КОГДА АктивныеТочки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.День)
			ТОГДА НАЧАЛОПЕРИОДА(ПодтвержденыеДоговораСПокупателямиСрезПервых.Период, ДЕНЬ)
		КОГДА АктивныеТочки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Неделя)
			ТОГДА НАЧАЛОПЕРИОДА(ПодтвержденыеДоговораСПокупателямиСрезПервых.Период, НЕДЕЛЯ)
		КОГДА АктивныеТочки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Месяц)
			ТОГДА НАЧАЛОПЕРИОДА(ПодтвержденыеДоговораСПокупателямиСрезПервых.Период, МЕСЯЦ)
		КОГДА АктивныеТочки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Квартал)
			ТОГДА НАЧАЛОПЕРИОДА(ПодтвержденыеДоговораСПокупателямиСрезПервых.Период, КВАРТАЛ)
		КОГДА АктивныеТочки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Год)
			ТОГДА НАЧАЛОПЕРИОДА(ПодтвержденыеДоговораСПокупателямиСрезПервых.Период, ГОД)
	КОНЕЦ КАК Период,
	АктивныеТочки.ВидПериода КАК ВидПериода,
	СУММА(ПроданнаяНедвижимостьОбороты.КоличествоОборот) КАК КоличествоСделокВторички,
	СУММА(ПроданнаяНедвижимостьОбороты.СуммаОборот) КАК СуммаПродажиВторички
ПОМЕСТИТЬ ПроданоВторички
ИЗ
	АктивныеТочкиТрейдИн КАК АктивныеТочки
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.УПДК_ПодтвержденыеДоговораСПокупателями.СрезПоследних({(&ДатаОкончания)}, ВидПодтверждения = &ВидПодтвержденияДоговора) КАК ПодтвержденыеДоговораСПокупателямиСрезПоследних
		ПО (ИСТИНА)
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.УПДК_ПодтвержденыеДоговораСПокупателями.СрезПервых(, ВидПодтверждения = &ВидПодтвержденияДоговора) КАК ПодтвержденыеДоговораСПокупателямиСрезПервых
		ПО (ПодтвержденыеДоговораСПокупателямиСрезПоследних.ДоговорСПокупателем = ПодтвержденыеДоговораСПокупателямиСрезПервых.ДоговорСПокупателем)
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.УПДК_ПродажиНедвижимости.Обороты(
				{(&ДатаНачала)},
				{(&ДатаОкончания)},
				Авто,
				ДоговорСПокупателем.Организация В (&Организация)
					И ДоговорСПокупателем.Статус = ЗНАЧЕНИЕ(перечисление.СтатусыДоговоровСПокупателями.подписан)) КАК ПроданнаяНедвижимостьОбороты
		ПО (ПодтвержденыеДоговораСПокупателямиСрезПоследних.ДоговорСПокупателем = ПроданнаяНедвижимостьОбороты.ДоговорСПокупателем)
ГДЕ
	ПодтвержденыеДоговораСПокупателямиСрезПоследних.Подтвержден
{ГДЕ
	(НАЧАЛОПЕРИОДА(ПодтвержденыеДоговораСПокупателямиСрезПоследних.Период, ДЕНЬ) >= &ДатаНачала),
	(НАЧАЛОПЕРИОДА(ПодтвержденыеДоговораСПокупателямиСрезПоследних.Период, ДЕНЬ) <= &ДатаОкончания)}

СГРУППИРОВАТЬ ПО
	ВЫБОР
		КОГДА АктивныеТочки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.День)
			ТОГДА НАЧАЛОПЕРИОДА(ПодтвержденыеДоговораСПокупателямиСрезПервых.Период, ДЕНЬ)
		КОГДА АктивныеТочки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Неделя)
			ТОГДА НАЧАЛОПЕРИОДА(ПодтвержденыеДоговораСПокупателямиСрезПервых.Период, НЕДЕЛЯ)
		КОГДА АктивныеТочки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Месяц)
			ТОГДА НАЧАЛОПЕРИОДА(ПодтвержденыеДоговораСПокупателямиСрезПервых.Период, МЕСЯЦ)
		КОГДА АктивныеТочки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Квартал)
			ТОГДА НАЧАЛОПЕРИОДА(ПодтвержденыеДоговораСПокупателямиСрезПервых.Период, КВАРТАЛ)
		КОГДА АктивныеТочки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Год)
			ТОГДА НАЧАЛОПЕРИОДА(ПодтвержденыеДоговораСПокупателямиСрезПервых.Период, ГОД)
	КОНЕЦ,
	АктивныеТочки.ВидПериода
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВЫБОР
		КОГДА АктивныеТочки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.День)
			ТОГДА НАЧАЛОПЕРИОДА(ПодтвержденыеДоговораСПокупателямиСрезПервых.Период, ДЕНЬ)
		КОГДА АктивныеТочки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Неделя)
			ТОГДА НАЧАЛОПЕРИОДА(ПодтвержденыеДоговораСПокупателямиСрезПервых.Период, НЕДЕЛЯ)
		КОГДА АктивныеТочки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Месяц)
			ТОГДА НАЧАЛОПЕРИОДА(ПодтвержденыеДоговораСПокупателямиСрезПервых.Период, МЕСЯЦ)
		КОГДА АктивныеТочки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Квартал)
			ТОГДА НАЧАЛОПЕРИОДА(ПодтвержденыеДоговораСПокупателямиСрезПервых.Период, КВАРТАЛ)
		КОГДА АктивныеТочки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Год)
			ТОГДА НАЧАЛОПЕРИОДА(ПодтвержденыеДоговораСПокупателямиСрезПервых.Период, ГОД)
	КОНЕЦ КАК Период,
	АктивныеТочки.ВидПериода КАК ВидПериода,
	СУММА(ПроданнаяНедвижимостьОбороты.КоличествоОборот) КАК КоличествоСделокВторичкиСАН
ПОМЕСТИТЬ ПроданоВторичкиСАН
ИЗ
	АктивныеТочкиТрейдИн КАК АктивныеТочки
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.УПДК_ПодтвержденыеДоговораСПокупателями.СрезПоследних({(&ДатаОкончания)}, ВидПодтверждения = &ВидПодтвержденияДоговора) КАК ПодтвержденыеДоговораСПокупателямиСрезПоследних
		ПО (ИСТИНА)
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.УПДК_ПодтвержденыеДоговораСПокупателями.СрезПервых(, ВидПодтверждения = &ВидПодтвержденияДоговора) КАК ПодтвержденыеДоговораСПокупателямиСрезПервых
		ПО (ПодтвержденыеДоговораСПокупателямиСрезПоследних.ДоговорСПокупателем = ПодтвержденыеДоговораСПокупателямиСрезПервых.ДоговорСПокупателем)
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрНакопления.УПДК_ПродажиНедвижимости.Обороты(
				{(&ДатаНачала)},
				{(&ДатаОкончания)},
				Авто,
				ДоговорСПокупателем.Организация В (&Организация)
					И ДоговорСПокупателем.Статус = ЗНАЧЕНИЕ(перечисление.СтатусыДоговоровСПокупателями.подписан)
					И ДоговорСПокупателем.АгентствоНедвижимости <> ЗНАЧЕНИЕ(Справочник.Партнеры.Пустаяссылка)) КАК ПроданнаяНедвижимостьОбороты
		ПО (ПодтвержденыеДоговораСПокупателямиСрезПоследних.ДоговорСПокупателем = ПроданнаяНедвижимостьОбороты.ДоговорСПокупателем)
ГДЕ
	ПодтвержденыеДоговораСПокупателямиСрезПоследних.Подтвержден
{ГДЕ
	(НАЧАЛОПЕРИОДА(ПодтвержденыеДоговораСПокупателямиСрезПоследних.Период, ДЕНЬ) >= &ДатаНачала),
	(НАЧАЛОПЕРИОДА(ПодтвержденыеДоговораСПокупателямиСрезПоследних.Период, ДЕНЬ) <= &ДатаОкончания)}

СГРУППИРОВАТЬ ПО
	ВЫБОР
		КОГДА АктивныеТочки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.День)
			ТОГДА НАЧАЛОПЕРИОДА(ПодтвержденыеДоговораСПокупателямиСрезПервых.Период, ДЕНЬ)
		КОГДА АктивныеТочки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Неделя)
			ТОГДА НАЧАЛОПЕРИОДА(ПодтвержденыеДоговораСПокупателямиСрезПервых.Период, НЕДЕЛЯ)
		КОГДА АктивныеТочки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Месяц)
			ТОГДА НАЧАЛОПЕРИОДА(ПодтвержденыеДоговораСПокупателямиСрезПервых.Период, МЕСЯЦ)
		КОГДА АктивныеТочки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Квартал)
			ТОГДА НАЧАЛОПЕРИОДА(ПодтвержденыеДоговораСПокупателямиСрезПервых.Период, КВАРТАЛ)
		КОГДА АктивныеТочки.ВидПериода = ЗНАЧЕНИЕ(Перечисление.Периодичность.Год)
			ТОГДА НАЧАЛОПЕРИОДА(ПодтвержденыеДоговораСПокупателямиСрезПервых.Период, ГОД)
	КОНЕЦ,
	АктивныеТочки.ВидПериода
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	ВложенныйЗапрос.Период КАК Период,
	ВложенныйЗапрос.ВидПериода КАК ВидПериода,
	СУММА(ЕСТЬNULL(ВложенныйЗапрос.КоличествоВыкупВторички, 0)) КАК КоличествоВыкупВторички,
	СУММА(ЕСТЬNULL(ВложенныйЗапрос.СуммаПродажВыкупВторички, 0)) КАК СуммаПродажВыкупВторички,
	СУММА(ЕСТЬNULL(ВложенныйЗапрос.КоличествоСделокСТИ, 0)) КАК КоличествоСделокСТИ,
	СУММА(ЕСТЬNULL(ВложенныйЗапрос.СуммаПродажиСТИ, 0)) КАК СуммаПродажиСТИ,
	СУММА(ЕСТЬNULL(ВложенныйЗапрос.КоличествоСделокВторички, 0)) КАК КоличествоСделокВторички,
	СУММА(ЕСТЬNULL(ВложенныйЗапрос.СуммаПродажиВторички, 0)) КАК СуммаПродажиВторички,
	СУММА(ЕСТЬNULL(ВложенныйЗапрос.КоличествоСделокВторичкиСАН, 0)) КАК КоличествоСделокВторичкиСАН
ПОМЕСТИТЬ ФактическиеПоказатели
ИЗ
	(ВЫБРАТЬ
		ВыкупленоВторички.Период КАК Период,
		ВыкупленоВторички.ВидПериода КАК ВидПериода,
		ВыкупленоВторички.КоличествоВыкупВторички КАК КоличествоВыкупВторички,
		ВыкупленоВторички.СуммаПродажВыкупВторички КАК СуммаПродажВыкупВторички,
		NULL КАК КоличествоСделокСТИ,
		NULL КАК СуммаПродажиСТИ,
		NULL КАК КоличествоСделокВторички,
		NULL КАК СуммаПродажиВторички,
		NULL КАК КоличествоСделокВторичкиСАН
	ИЗ
		ВыкупленоВторички КАК ВыкупленоВторички
	
	ОБЪЕДИНИТЬ ВСЕ
	
	ВЫБРАТЬ
		ЗаключенныеДоговораСТИ.Период,
		ЗаключенныеДоговораСТИ.ВидПериода,
		NULL,
		NULL,
		ЗаключенныеДоговораСТИ.КоличествоСделокСТИ,
		ЗаключенныеДоговораСТИ.СуммаПродажиСТИ,
		NULL,
		NULL,
		NULL
	ИЗ
		ЗаключенныеДоговораСТИ КАК ЗаключенныеДоговораСТИ
	
	ОБЪЕДИНИТЬ ВСЕ
	
	ВЫБРАТЬ
		ПроданоВторички.Период,
		ПроданоВторички.ВидПериода,
		NULL,
		NULL,
		NULL,
		NULL,
		ПроданоВторички.КоличествоСделокВторички,
		ПроданоВторички.СуммаПродажиВторички,
		NULL
	ИЗ
		ПроданоВторички КАК ПроданоВторички
	
	ОБЪЕДИНИТЬ ВСЕ
	
	ВЫБРАТЬ
		ПроданоВторичкиСАН.Период,
		ПроданоВторичкиСАН.ВидПериода,
		NULL,
		NULL,
		NULL,
		NULL,
		NULL,
		NULL,
		ПроданоВторичкиСАН.КоличествоСделокВторичкиСАН
	ИЗ
		ПроданоВторичкиСАН КАК ПроданоВторичкиСАН) КАК ВложенныйЗапрос

СГРУППИРОВАТЬ ПО
	ВложенныйЗапрос.Период,
	ВложенныйЗапрос.ВидПериода
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Показатели.ВидПериода КАК ВидПериода,
	Показатели.Период КАК Период,
	Показатели.КоличествоВыкупВторички КАК КоличествоВыкупВторички,
	Показатели.СуммаПродажВыкупВторички КАК СуммаПродажВыкупВторички,
	Показатели.КоличествоСделокПланВторичка КАК КоличествоСделокПланВторичка,
	Показатели.КоличествоСделокСТИ КАК КоличествоСделокСТИ,
	Показатели.СуммаПродажиСТИ КАК СуммаПродажиСТИ,
	Показатели.КоличествоСделокПланТрейдИн КАК КоличествоСделокПланТрейдИн,
	Показатели.СуммаПродажиПланТрейдИн КАК СуммаПродажиПланТрейдИн,
	Показатели.КоличествоСделокВторички КАК КоличествоСделокВторички,
	Показатели.СуммаПродажиВторички КАК СуммаПродажиВторички,
	Показатели.КоличествоСделокВторичкиСАН КАК КоличествоСделокВторичкиСАН,
	ВЫБОР
		КОГДА Показатели.КоличествоСделокПланТрейдИн = 0
			ТОГДА 100
		ИНАЧЕ Показатели.КоличествоВыкупВторички / Показатели.КоличествоСделокПланТрейдИн * 100
	КОНЕЦ КАК ВыкупВторичкиШтПроц,
	ВЫБОР
		КОГДА Показатели.СуммаПродажиПланТрейдИн = 0
			ТОГДА 100
		ИНАЧЕ Показатели.СуммаПродажВыкупВторички / Показатели.СуммаПродажиПланТрейдИн * 100
	КОНЕЦ КАК ВыкупВторичкиРубПроц,
	ВЫБОР
		КОГДА Показатели.КоличествоСделокПланТрейдИн = 0
			ТОГДА 100
		ИНАЧЕ Показатели.КоличествоСделокСТИ / Показатели.КоличествоСделокПланТрейдИн * 100
	КОНЕЦ КАК ПродажиСТИШтПроц,
	ВЫБОР
		КОГДА Показатели.СуммаПродажиПланТрейдИн = 0
			ТОГДА 100
		ИНАЧЕ Показатели.СуммаПродажиСТИ / Показатели.СуммаПродажиПланТрейдИн * 100
	КОНЕЦ КАК ПродажиСТИРубПроц,
	ВЫБОР
		КОГДА Показатели.КоличествоСделокПланТрейдИн = 0
			ТОГДА 100
		ИНАЧЕ Показатели.КоличествоСделокВторички / Показатели.КоличествоСделокПланТрейдИн * 100
	КОНЕЦ КАК ПродажаВторичкиШтПроц
{ВЫБРАТЬ
	Период,
	КоличествоВыкупВторички,
	ВыкупВторичкиШтПроц,
	СуммаПродажВыкупВторички,
	ВыкупВторичкиРубПроц,
	КоличествоСделокПланВторичка,
	КоличествоСделокСТИ,
	ПродажиСТИШтПроц,
	СуммаПродажиСТИ,
	ПродажиСТИРубПроц,
	КоличествоСделокПланТрейдИн,
	СуммаПродажиПланТрейдИн,
	СуммаПродажиВторички,
	ПродажаВторичкиШтПроц,
	КоличествоСделокВторички,
	КоличествоСделокВторичкиСАН,
	ВидПериода.*}
ИЗ
	(ВЫБРАТЬ
		ПлановыеПоказатели.ВидПериода КАК ВидПериода,
		ПлановыеПоказатели.Период КАК Период,
		ПлановыеПоказатели.КоличествоСделокТрейдИн КАК КоличествоСделокПланТрейдИн,
		ПлановыеПоказатели.СуммаПродажиТрейдИн КАК СуммаПродажиПланТрейдИн,
		ПлановыеПоказатели.КоличествоСделокВторичка КАК КоличествоСделокПланВторичка,
		ПлановыеПоказатели.СуммаПродажиВторичка КАК СуммаПродажиПланВторичка,
		NULL КАК КоличествоВыкупВторички,
		NULL КАК СуммаПродажВыкупВторички,
		NULL КАК КоличествоСделокСТИ,
		NULL КАК СуммаПродажиСТИ,
		NULL КАК КоличествоСделокВторички,
		NULL КАК СуммаПродажиВторички,
		NULL КАК КоличествоСделокВторичкиСАН
	ИЗ
		ПлановыеПоказатели КАК ПлановыеПоказатели
	
	ОБЪЕДИНИТЬ ВСЕ
	
	ВЫБРАТЬ
		ФактическиеПоказатели.ВидПериода,
		ФактическиеПоказатели.Период,
		NULL,
		NULL,
		NULL,
		NULL,
		ФактическиеПоказатели.КоличествоВыкупВторички,
		ФактическиеПоказатели.СуммаПродажВыкупВторички,
		ФактическиеПоказатели.КоличествоСделокСТИ,
		ФактическиеПоказатели.СуммаПродажиСТИ,
		ФактическиеПоказатели.КоличествоСделокВторички,
		ФактическиеПоказатели.СуммаПродажиВторички,
		ФактическиеПоказатели.КоличествоСделокВторичкиСАН
	ИЗ
		ФактическиеПоказатели КАК ФактическиеПоказатели) КАК Показатели