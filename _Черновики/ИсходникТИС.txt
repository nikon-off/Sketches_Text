ВЫБРАТЬ РАЗЛИЧНЫЕ
	ОбменССайтомРайоны.Район КАК Район
ПОМЕСТИТЬ Районы
ИЗ
	ПланОбмена.ОбменССайтом.Районы КАК ОбменССайтомРайоны
ГДЕ
	ОбменССайтомРайоны.Ссылка = &УзелОбмена
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	УПДК_ПараметрыНедвижимости.ОбъектНедвижимостиИсходный КАК ОбъектНедвижимостиИсходный,
	ВЫБОР
		КОГДА АренднаяНедвижимостьСрезПоследних.Активность ЕСТЬ NULL
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ КАК ЭтоАренда
ПОМЕСТИТЬ ВТОбъектыНедвижимостиСтарые
ИЗ
	РегистрСведений.УПДК_ПараметрыНедвижимости КАК УПДК_ПараметрыНедвижимости    
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АренднаяНедвижимость.СрезПоследних КАК АренднаяНедвижимостьСрезПоследних
		ПО УПДК_ПараметрыНедвижимости.ОбъектНедвижимости = АренднаяНедвижимостьСрезПоследних.ОбъектНедвижимости
ГДЕ
	УПДК_ПараметрыНедвижимости.ОбъектНедвижимостиИсходный <> УПДК_ПараметрыНедвижимости.ОбъектНедвижимости
	И УПДК_ПараметрыНедвижимости.ОбъектНедвижимостиИсходный <> ЗНАЧЕНИЕ(Справочник.УПДК_ОбъектыНедвижимости.ПустаяСсылка)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ПараметрыНедвижимости.Район КАК Район,
	ПараметрыНедвижимости.Объект КАК Объект,
	ПараметрыНедвижимости.Секция КАК Секция,
	ПараметрыНедвижимости.Этаж КАК Этаж,
	ПараметрыНедвижимости.НомерНаЭтаже КАК НомерНаЭтаже,
	ПараметрыНедвижимости.ОбъектНедвижимости КАК ОбъектНедвижимости,
	ЭтапыСтроительстваОбъектовСрезПоследних.ЭтапСтроительства КАК ЭтапСтроительства,
	ЭтапыСтроительстваОбъектовСрезПоследних.ПроцентГотовностиОбъекта КАК ПроцентГотовностиОбъекта,
	ЭтапыСтроительстваОбъектовСрезПоследних.ОписаниеГотовностиОбъекта КАК ОписаниеГотовностиОбъекта,
	ВЫБОР
		КОГДА НедвижимостьСрезПоследних.Договор <> ЗНАЧЕНИЕ(Документ.РеализацияНедвижимости.пустаяссылка)
			ТОГДА ЗНАЧЕНИЕ(Перечисление.УПДК_СтатусыНедвижимости.НаОформлении)
		КОГДА НЕ АренднаяНедвижимостьСрезПоследних.Активность ЕСТЬ NULL
			ТОГДА АренднаяНедвижимостьСрезПоследних.СтатусНедвижимости
		КОГДА СнятыеКвартирыСПродажСрезПоследних.Активность ЕСТЬ NULL
			ТОГДА НедвижимостьСрезПоследних.СтатусНедвижимости
		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.УПДК_СтатусыНедвижимости.Продано)
	КОНЕЦ КАК СтатусНедвижимости,
	ПараметрыНедвижимости.ОбъектНедвижимости.ОбщаяПлощадь КАК ОбщаяПлощадь,
	ПараметрыНедвижимости.ОбъектНедвижимости.НомерУсловный КАК Номер,
	ПараметрыНедвижимости.ОбъектНедвижимости.КоличествоКомнат КАК КоличествоКомнат,
	ПараметрыНедвижимости.ОбъектНедвижимости.Отделка КАК Отделка,
	ПараметрыНедвижимости.ОбъектНедвижимости.Уровней КАК КоличествоУровней,
	ПараметрыНедвижимости.ОбъектНедвижимости.ТипПланировки КАК ТипПланировки,
	ПараметрыНедвижимости.ОбъектНедвижимости.Описание КАК Описание,
	ВЫБОР
		КОГДА АренднаяНедвижимостьСрезПоследних.Активность ЕСТЬ NULL
			ТОГДА ФактическиеЦеныНедвижимости.Стоимость
		ИНАЧЕ ФактическиеЦеныНедвижимостиАренда.Стоимость
	КОНЕЦ КАК СтоимостьНедвижимости,
	ПараметрыНедвижимости.ОбъектНедвижимости.ПлощадьКухни КАК ПлощадьКухни,
	ПараметрыНедвижимости.ОбъектНедвижимости.Планировка КАК Планировка,
	ПараметрыНедвижимости.ОбъектНедвижимости.Вторичный КАК Вторичный,
	ВЫБОР
		КОГДА ПараметрыНедвижимости.ОбъектНедвижимости.ПлощадьЖилаяБТИ = 0
			ТОГДА ПараметрыНедвижимости.ОбъектНедвижимости.ПлощадьЖилая
		ИНАЧЕ ПараметрыНедвижимости.ОбъектНедвижимости.ПлощадьЖилаяБТИ
	КОНЕЦ КАК ЖилаяПлощадь,
	ВЫБОР
		КОГДА ПараметрыНедвижимости.ОбъектНедвижимости.ОбщаяПлощадьПриведеннаяБТИ = 0
			ТОГДА ПараметрыНедвижимости.ОбъектНедвижимости.ОбщаяПлощадьПриведенная
		ИНАЧЕ ПараметрыНедвижимости.ОбъектНедвижимости.ОбщаяПлощадьПриведеннаяБТИ
	КОНЕЦ КАК ПриведеннаяПлощадь,
	ВЫБОР
		КОГДА АренднаяНедвижимостьСрезПоследних.Активность ЕСТЬ NULL
			ТОГДА ЛОЖЬ
		ИНАЧЕ ИСТИНА
	КОНЕЦ КАК ЭтоАренда
ПОМЕСТИТЬ ВремНедвижимость
ИЗ
	РегистрСведений.УПДК_ПараметрыНедвижимости КАК ПараметрыНедвижимости
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УПДК_Недвижимость.СрезПоследних(
				,
				ОбъектНедвижимости.Район В
					(ВЫБРАТЬ
						Районы.Район
					ИЗ
						Районы КАК Районы)) КАК НедвижимостьСрезПоследних
		ПО ПараметрыНедвижимости.ОбъектНедвижимости = НедвижимостьСрезПоследних.ОбъектНедвижимости
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УПДК_ЭтапыСтроительстваОбъектов.СрезПоследних(
				,
				Район В
					(ВЫБРАТЬ
						Районы.Район
					ИЗ
						Районы КАК Районы)) КАК ЭтапыСтроительстваОбъектовСрезПоследних
		ПО ПараметрыНедвижимости.Объект = ЭтапыСтроительстваОбъектовСрезПоследних.Объект
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УПДК_ФактическиеЦеныНедвижимости КАК ФактическиеЦеныНедвижимости
		ПО ПараметрыНедвижимости.ОбъектНедвижимости = ФактическиеЦеныНедвижимости.ОбъектНедвижимости
			И (ФактическиеЦеныНедвижимости.ВидЦены = &ВидЦены)
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УПДК_ФактическиеЦеныНедвижимости КАК ФактическиеЦеныНедвижимостиАренда
		ПО ПараметрыНедвижимости.ОбъектНедвижимости = ФактическиеЦеныНедвижимостиАренда.ОбъектНедвижимости
			И (ФактическиеЦеныНедвижимостиАренда.ВидЦены = &ВидЦеныАренда)
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.СнятыеКвартирыСПродаж.СрезПоследних(, ) КАК СнятыеКвартирыСПродажСрезПоследних
		ПО ПараметрыНедвижимости.ОбъектНедвижимости = СнятыеКвартирыСПродажСрезПоследних.ОбъектНедвижимости
			И (СнятыеКвартирыСПродажСрезПоследних.Активность)
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АренднаяНедвижимость.СрезПоследних КАК АренднаяНедвижимостьСрезПоследних
		ПО ПараметрыНедвижимости.ОбъектНедвижимости = АренднаяНедвижимостьСрезПоследних.ОбъектНедвижимости
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.УПДК_ЗабронированнаяНедвижимость.СрезПоследних(, ) КАК УПДК_ЗабронированнаяНедвижимостьСрезПоследних
		ПО ПараметрыНедвижимости.ОбъектНедвижимости = УПДК_ЗабронированнаяНедвижимостьСрезПоследних.ОбъектНедвижимости
			И (ТИПЗНАЧЕНИЯ(УПДК_ЗабронированнаяНедвижимостьСрезПоследних.Регистратор) = ТИП(Документ.УПДК_ЗаказКлиента))
			И (УПДК_ЗабронированнаяНедвижимостьСрезПоследних.Бессроночное)
ГДЕ
	ПараметрыНедвижимости.Район В
			(ВЫБРАТЬ
				Районы.Район
			ИЗ
				Районы КАК Районы)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВремНедвижимость.Район КАК Район,
	ВремНедвижимость.Объект КАК Объект,
	ВремНедвижимость.Секция КАК Секция,
	ВремНедвижимость.Этаж КАК Этаж,
	ВремНедвижимость.НомерНаЭтаже КАК НомерНаЭтаже,
	ВремНедвижимость.ЭтапСтроительства КАК ЭтапСтроительства,
	ВремНедвижимость.ПроцентГотовностиОбъекта КАК ПроцентГотовностиОбъекта,
	ВремНедвижимость.ОписаниеГотовностиОбъекта КАК ОписаниеГотовностиОбъекта,
	ВремНедвижимость.СтатусНедвижимости КАК СтатусНедвижимости,
	ВремНедвижимость.ОбщаяПлощадь КАК ОбщаяПлощадь,
	ВремНедвижимость.Номер КАК Номер,
	ВремНедвижимость.КоличествоКомнат КАК КоличествоКомнат,
	ВремНедвижимость.Отделка КАК Отделка,
	ВремНедвижимость.КоличествоУровней КАК КоличествоУровней,
	ВремНедвижимость.ТипПланировки КАК ТипПланировки,
	ВремНедвижимость.Описание КАК Описание,
	ВремНедвижимость.СтоимостьНедвижимости КАК СтоимостьНедвижимости,
	ВремНедвижимость.ОбъектНедвижимости КАК ОбъектНедвижимости,
	ВремНедвижимость.ПлощадьКухни КАК ПлощадьКухни,
	ВремНедвижимость.Планировка КАК Планировка,
	ВремНедвижимость.Вторичный КАК Вторичный,
	ВремНедвижимость.ЖилаяПлощадь КАК ЖилаяПлощадь,
	ВремНедвижимость.ПриведеннаяПлощадь КАК ПриведеннаяПлощадь,
	ВремНедвижимость.ЭтоАренда КАК ЭтоАренда
ИЗ
	ВремНедвижимость КАК ВремНедвижимость
		ЛЕВОЕ СОЕДИНЕНИЕ ВТОбъектыНедвижимостиСтарые КАК ВТОбъектыНедвижимостиСтарые
		ПО ВремНедвижимость.ОбъектНедвижимости = ВТОбъектыНедвижимостиСтарые.ОбъектНедвижимостиИсходный
ГДЕ
	(ВТОбъектыНедвижимостиСтарые.ОбъектНедвижимостиИсходный ЕСТЬ NULL
			ИЛИ ВТОбъектыНедвижимостиСтарые.ЭтоАренда
				И &ВыгружатьПервичкуАренды)